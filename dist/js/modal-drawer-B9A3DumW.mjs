var u=(e,f,i)=>new Promise((l,m)=>{var b=a=>{try{s(i.next(a))}catch(t){m(t)}},n=a=>{try{s(i.throw(a))}catch(t){m(t)}},s=a=>a.done?l(a.value):Promise.resolve(a.value).then(b,n);s((i=i.apply(e,f)).next())});import{I as d,K as p,$ as _,l as v}from"./bootstrap-CIlPtDbU.mjs";import{u as C}from"./vxe-table-CS5KFeE-.mjs";import{g,r as h}from"./render-C5tDa4zc.mjs";import{a9 as L,Q as q,J as P,a3 as x,b2 as O,at as T,au as k,av as y,n as S,a8 as I,ar as V}from"../jse/index-index-CulmqKVw.mjs";import{u as B}from"./use-drawer-0pSlBI5S.mjs";function U(e){return d.get("/system/model/list",{params:e})}function F(e){return d.get(`/system/model/${e}`)}function H(e){return d.putWithMsg("/system/model",e)}function M(e){return d.postWithMsg("/system/model",e)}function z(e){return d.deleteWithMsg(`/system/model/${e}`)}const J=()=>[{component:"Input",fieldName:"modelName",label:"模型名称"},{component:"RangePicker",fieldName:"createTime",label:"创建时间"}],Q=[{type:"checkbox",width:60},{title:"模型名称",field:"modelName"},{title:"模型描述",field:"modelDescribe"},{title:"模型价格",field:"modelPrice"},{title:"请求地址",field:"apiHost"},{title:"请求密钥",field:"apiKey"},{title:"计费类型",field:"modelType",width:120,slots:{default:({row:e})=>h(e.modelType,p.SYS_MODEL_BILLING)}},{title:"是否显示",field:"modelShow",width:120,slots:{default:({row:e})=>h(e.modelShow,p.SYS_SHOW_HIDE)}},{title:"备注",field:"remark"},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",width:180}],$=()=>[{component:"Input",dependencies:{show:()=>!1,triggerFields:[""]},fieldName:"id",label:"模型主键"},{component:"Input",fieldName:"modelName",label:"模型名称",rules:"required"},{component:"Input",fieldName:"modelDescribe",label:"模型描述",rules:"required"},{component:"Input",fieldName:"modelPrice",label:"模型价格",rules:"required"},{component:"Input",fieldName:"apiHost",label:"请求地址",rules:"required"},{component:"Input",fieldName:"apiKey",label:"请求密钥",rules:"required"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:g(p.SYS_SHOW_HIDE),optionType:"button"},defaultValue:"1",fieldName:"modelShow",label:"是否显示",rules:"required"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:g(p.SYS_MODEL_BILLING),optionType:"button"},defaultValue:"1",fieldName:"modelType",label:"计费类型",rules:"required"},{component:"Textarea",fieldName:"remark",formItemClass:"items-baseline",label:"备注"}],E=L({__name:"modal-drawer",emits:["reload"],setup(e,{emit:f}){const i=f,l=q(!1),m=P(()=>l.value?_("pages.common.edit"):_("pages.common.add")),[b,n]=C({commonConfig:{formItemClass:"col-span-2"},layout:"vertical",schema:$(),showDefaultActions:!1,wrapperClass:"grid-cols-2"});function s(o){n.updateSchema([{dependencies:{show:()=>o,triggerFields:[""]},fieldName:"clientId"},{componentProps:{disabled:o},fieldName:"clientKey"},{componentProps:{disabled:o},fieldName:"clientSecret"}])}const[a,t]=B({onCancel:w,onConfirm:N,onOpenChange(o){return u(this,null,function*(){if(!o)return null;t.drawerLoading(!0);const{id:r}=t.getData();if(l.value=!!r,s(l.value),l.value&&r){const c=yield F(r);n.updateSchema([{componentProps:{disabled:c.id===1},fieldName:"status"}]),yield n.setValues(c)}t.drawerLoading(!1)})}});function N(){return u(this,null,function*(){try{t.drawerLoading(!0);const{valid:o}=yield n.validate();if(!o)return;const r=x(yield n.getValues());yield l.value?H(r):M(r),i("reload"),yield w()}catch(o){console.error(o)}finally{t.drawerLoading(!1)}})}function w(){return u(this,null,function*(){t.close(),yield n.resetForm()})}return(o,r)=>{const c=O("SecretInput");return T(),k(I(a),{"close-on-click-modal":!1,title:m.value,class:"w-[600px]"},{default:y(()=>[S(I(b),null,{clientSecret:y(D=>[S(c,V(D,{disabled:l.value}),null,16,["disabled"])]),_:1})]),_:1},8,["title"])}}}),W=v(E,[["__scopeId","data-v-5403d4ef"]]),X=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{z as a,U as b,Q as c,X as d,W as m,J as q};
