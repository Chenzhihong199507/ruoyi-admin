var m=(e,p,l)=>new Promise((s,d)=>{var u=a=>{try{c(l.next(a))}catch(t){d(t)}},o=a=>{try{c(l.throw(a))}catch(t){d(t)}},c=a=>a.done?s(a.value):Promise.resolve(a.value).then(u,o);c((l=l.apply(e,p)).next())});import{bC as C,s as b,$ as g,l as I}from"./bootstrap-CIlPtDbU.mjs";import{u as v}from"./vxe-table-CS5KFeE-.mjs";import{a as P,b as D}from"./index-Dp5S5Jis.mjs";import{d as y}from"./index-CFKk8jMF.mjs";import{p as _}from"./index-DV4CYNzU.mjs";import{g as k}from"./get-popup-container-BwMHEyJY.mjs";import{T as x}from"./index-BsPmTjuM.mjs";import{a9 as Y,Q as T,J as S,a3 as q,at as L,au as F,av as M,n as B,a8 as h,h as f}from"../jse/index-index-CulmqKVw.mjs";import{u as H}from"./use-drawer-0pSlBI5S.mjs";const X=()=>[{component:"Input",fieldName:"tenantId",label:"租户编号"},{component:"Input",fieldName:"companyName",label:"租户名称"},{component:"Input",fieldName:"contactUserName",label:"联系人"},{component:"Input",fieldName:"contactPhone",label:"联系电话"}],Z=[{type:"checkbox",width:60},{title:"租户编号",field:"tenantId"},{title:"租户名称",field:"companyName"},{title:"联系人",field:"contactUserName"},{title:"联系电话",field:"contactPhone"},{title:"到期时间",field:"expireTime",formatter:({cellValue:e})=>e||"无期限"},{title:"租户状态",field:"status",slots:{default:"status"}},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",width:180}],V=C().add(365,"days").startOf("day").format("YYYY-MM-DD HH:mm:ss"),U=()=>[{component:"Input",dependencies:{show:()=>!1,triggerFields:[""]},fieldName:"id",label:"id"},{component:"Input",dependencies:{show:()=>!1,triggerFields:[""]},fieldName:"tenantId",label:"tenantId"},{component:"Divider",componentProps:{orientation:"center"},fieldName:"divider1",labelClass:"w-0",renderComponentContent:()=>({default:()=>"基本信息"})},{component:"Input",fieldName:"companyName",label:"企业名称",rules:"required"},{component:"Input",fieldName:"contactUserName",label:"联系人",rules:"required"},{component:"Input",fieldName:"contactPhone",label:"联系电话",rules:b().regex(/^1[3-9]\d{9}$/,{message:"请输入正确的联系电话"})},{component:"Divider",componentProps:{orientation:"center"},fieldName:"divider2",labelClass:"w-0",renderComponentContent:()=>({default:()=>"管理员信息"})},{component:"Input",fieldName:"username",label:"用户账号",rules:"required"},{component:"InputPassword",fieldName:"password",label:"密码",rules:"required"},{component:"Divider",componentProps:{orientation:"center"},fieldName:"divider3",labelClass:"w-0",renderComponentContent:()=>({default:()=>"租户设置"})},{component:"Select",componentProps:{class:"w-full",getPopupContainer:k},fieldName:"packageId",label:"租户套餐",rules:"selectRequired"},{component:"DatePicker",componentProps:{format:"YYYY-MM-DD HH:mm:ss",showTime:!0,valueFormat:"YYYY-MM-DD HH:mm:ss"},defaultValue:V,fieldName:"expireTime",help:`已经设置过期时间不允许重置为'无期限'
即在开通时未设置无期限 以后都不允许设置`,label:"过期时间"},{component:"InputNumber",componentProps:{min:-1},defaultValue:-1,fieldName:"accountCount",help:"-1不限制用户数量",label:"用户数量",renderComponentContent(e){return{addonBefore:()=>e.accountCount===-1?"不限制数量":"输入数量"}},rules:"required"},{component:"Input",fieldName:"domain",help:"可填写域名/端口 填写域名如: www.test.com 或者 www.test.com:8080 填写ip:端口如: 127.0.0.1:8080",label:"绑定域名",renderComponentContent(){return{addonBefore:()=>"http(s)://"}},rules:b().refine(e=>!(e.startsWith("http://")||e.startsWith("https://")),{message:"请输入正确的域名, 不需要http(s)"}).optional()},{component:"Divider",componentProps:{orientation:"center"},fieldName:"divider4",labelClass:"w-0",renderComponentContent:()=>({default:()=>"企业信息"})},{component:"Input",fieldName:"address",label:"企业地址"},{component:"Input",fieldName:"licenseNumber",label:"企业代码"},{component:"Textarea",fieldName:"intro",formItemClass:"items-baseline",label:"企业介绍"},{component:"Textarea",fieldName:"remark",formItemClass:"items-baseline",label:"备注"}],$=Y({__name:"tenant-drawer",emits:["reload"],setup(e,{emit:p}){const l=p,s=T(!1),d=S(()=>s.value?g("pages.common.edit"):g("pages.common.add")),[u,o]=v({commonConfig:{formItemClass:"col-span-2",labelWidth:100},schema:U(),showDefaultActions:!1,wrapperClass:"grid-cols-2"});function c(){return m(this,null,function*(){const n=(yield _()).map(i=>({label:f("div",{class:"flex items-center gap-[6px]"},[f("span",null,i.packageName),f(x,{color:"processing"},()=>`${i.menuIds.length}个菜单项`)]),title:i.packageName,value:i.packageId}));o.updateSchema([{componentProps:{optionFilterProp:"title",optionLabelProp:"title",options:n,showSearch:!0},fieldName:"packageId"}])})}const[a,t]=H({onCancel:w,onConfirm:N,onOpenChange(r){return m(this,null,function*(){if(!r)return null;t.drawerLoading(!0);const{id:n}=t.getData();if(s.value=!!n,yield c(),s.value&&n){const i=yield y(n);yield o.setValues(i)}t.drawerLoading(!1)})}});function N(){return m(this,null,function*(){try{t.drawerLoading(!0);const{valid:r}=yield o.validate();if(!r)return;const n=q(yield o.getValues());yield s.value?P(n):D(n),l("reload"),yield w()}catch(r){console.error(r)}finally{t.drawerLoading(!1)}})}function w(){return m(this,null,function*(){t.close(),yield o.resetForm()})}return(r,n)=>(L(),F(h(a),{"close-on-click-modal":!1,title:d.value,class:"w-[600px]"},{default:M(()=>[B(h(u))]),_:1},8,["title"]))}}),A=I($,[["__scopeId","data-v-bb878a49"]]),ee=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{ee as a,Z as c,X as q,A as t};
