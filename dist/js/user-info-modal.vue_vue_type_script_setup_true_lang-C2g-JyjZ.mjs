var H=(s,c,o)=>new Promise((a,f)=>{var l=h=>{try{y(o.next(h))}catch(r){f(r)}},M=h=>{try{y(o.throw(h))}catch(r){f(r)}},y=h=>h.done?a(h.value):Promise.resolve(h.value).then(l,M);y((o=o.apply(s,c)).next())});import{f as G}from"./index-DxROXI-t.mjs";import{u as J,_ as K}from"./useDescription-D4BFEr9E.mjs";import{bC as I,K as U}from"./bootstrap-CIlPtDbU.mjs";import{am as F,an as P,n as Y,aD as E,a4 as Z,a9 as q,at as Q,au as X,av as tt,a8 as j}from"../jse/index-index-CulmqKVw.mjs";import{r as et}from"./render-C5tDa4zc.mjs";import{T as L}from"./index-BsPmTjuM.mjs";import{u as st}from"./use-modal-BmBYziM1.mjs";var V={exports:{}};(function(s,c){(function(o,a){s.exports=a()})(F,function(){var o,a,f=1e3,l=6e4,M=36e5,y=864e5,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,r=31536e6,m=2628e6,w=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,b={years:r,months:m,days:y,hours:M,minutes:l,seconds:f,milliseconds:1,weeks:6048e5},x=function(n){return n instanceof T},D=function(n,e,t){return new T(n,t,e.$l)},v=function(n){return a.p(n)+"s"},p=function(n){return n<0},N=function(n){return p(n)?Math.ceil(n):Math.floor(n)},O=function(n){return Math.abs(n)},_=function(n,e){return n?p(n)?{negative:!0,format:""+O(n)+e}:{negative:!1,format:""+n+e}:{negative:!1,format:""}},T=function(){function n(t,i,d){var u=this;if(this.$d={},this.$l=d,t===void 0&&(this.$ms=0,this.parseFromMilliseconds()),i)return D(t*b[v(i)],this);if(typeof t=="number")return this.$ms=t,this.parseFromMilliseconds(),this;if(typeof t=="object")return Object.keys(t).forEach(function(k){u.$d[v(k)]=t[k]}),this.calMilliseconds(),this;if(typeof t=="string"){var $=t.match(w);if($){var g=$.slice(2).map(function(k){return k!=null?Number(k):0});return this.$d.years=g[0],this.$d.months=g[1],this.$d.weeks=g[2],this.$d.days=g[3],this.$d.hours=g[4],this.$d.minutes=g[5],this.$d.seconds=g[6],this.calMilliseconds(),this}}return this}var e=n.prototype;return e.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(i,d){return i+(t.$d[d]||0)*b[d]},0)},e.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=N(t/r),t%=r,this.$d.months=N(t/m),t%=m,this.$d.days=N(t/y),t%=y,this.$d.hours=N(t/M),t%=M,this.$d.minutes=N(t/l),t%=l,this.$d.seconds=N(t/f),t%=f,this.$d.milliseconds=t},e.toISOString=function(){var t=_(this.$d.years,"Y"),i=_(this.$d.months,"M"),d=+this.$d.days||0;this.$d.weeks&&(d+=7*this.$d.weeks);var u=_(d,"D"),$=_(this.$d.hours,"H"),g=_(this.$d.minutes,"M"),k=this.$d.seconds||0;this.$d.milliseconds&&(k+=this.$d.milliseconds/1e3,k=Math.round(1e3*k)/1e3);var A=_(k,"S"),R=t.negative||i.negative||u.negative||$.negative||g.negative||A.negative,W=$.format||g.format||A.format?"T":"",C=(R?"-":"")+"P"+t.format+i.format+u.format+W+$.format+g.format+A.format;return C==="P"||C==="-P"?"P0D":C},e.toJSON=function(){return this.toISOString()},e.format=function(t){var i=t||"YYYY-MM-DDTHH:mm:ss",d={Y:this.$d.years,YY:a.s(this.$d.years,2,"0"),YYYY:a.s(this.$d.years,4,"0"),M:this.$d.months,MM:a.s(this.$d.months,2,"0"),D:this.$d.days,DD:a.s(this.$d.days,2,"0"),H:this.$d.hours,HH:a.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:a.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:a.s(this.$d.seconds,2,"0"),SSS:a.s(this.$d.milliseconds,3,"0")};return i.replace(h,function(u,$){return $||String(d[u])})},e.as=function(t){return this.$ms/b[v(t)]},e.get=function(t){var i=this.$ms,d=v(t);return d==="milliseconds"?i%=1e3:i=d==="weeks"?N(i/b[d]):this.$d[d],i||0},e.add=function(t,i,d){var u;return u=i?t*b[v(i)]:x(t)?t.$ms:D(t,this).$ms,D(this.$ms+u*(d?-1:1),this)},e.subtract=function(t,i){return this.add(t,i,!0)},e.locale=function(t){var i=this.clone();return i.$l=t,i},e.clone=function(){return D(this.$ms,this)},e.humanize=function(t){return o().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},e.valueOf=function(){return this.asMilliseconds()},e.milliseconds=function(){return this.get("milliseconds")},e.asMilliseconds=function(){return this.as("milliseconds")},e.seconds=function(){return this.get("seconds")},e.asSeconds=function(){return this.as("seconds")},e.minutes=function(){return this.get("minutes")},e.asMinutes=function(){return this.as("minutes")},e.hours=function(){return this.get("hours")},e.asHours=function(){return this.as("hours")},e.days=function(){return this.get("days")},e.asDays=function(){return this.as("days")},e.weeks=function(){return this.get("weeks")},e.asWeeks=function(){return this.as("weeks")},e.months=function(){return this.get("months")},e.asMonths=function(){return this.as("months")},e.years=function(){return this.get("years")},e.asYears=function(){return this.as("years")},n}(),S=function(n,e,t){return n.add(e.years()*t,"y").add(e.months()*t,"M").add(e.days()*t,"d").add(e.hours()*t,"h").add(e.minutes()*t,"m").add(e.seconds()*t,"s").add(e.milliseconds()*t,"ms")};return function(n,e,t){o=t,a=t().$utils(),t.duration=function(u,$){var g=t.locale();return D(u,{$l:g},$)},t.isDuration=x;var i=e.prototype.add,d=e.prototype.subtract;e.prototype.add=function(u,$){return x(u)?S(this,u,1):i.bind(this)(u,$)},e.prototype.subtract=function(u,$){return x(u)?S(this,u,-1):d.bind(this)(u,$)}}})})(V);var nt=V.exports;const rt=P(nt);var z={exports:{}};(function(s,c){(function(o,a){s.exports=a()})(F,function(){return function(o,a,f){o=o||{};var l=a.prototype,M={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function y(r,m,w,b){return l.fromToBase(r,m,w,b)}f.en.relativeTime=M,l.fromToBase=function(r,m,w,b,x){for(var D,v,p,N=w.$locale().relativeTime||M,O=o.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],_=O.length,T=0;T<_;T+=1){var S=O[T];S.d&&(D=b?f(r).diff(w,S.d,!0):w.diff(r,S.d,!0));var n=(o.rounding||Math.round)(Math.abs(D));if(p=D>0,n<=S.r||!S.r){n<=1&&T>0&&(S=O[T-1]);var e=N[S.l];x&&(n=x(""+n)),v=typeof e=="string"?e.replace("%d",n):e(n,m,S.l,p);break}}if(m)return v;var t=p?N.future:N.past;return typeof t=="function"?t(v):t.replace("%s",v)},l.to=function(r,m){return y(r,m,this,!0)},l.from=function(r,m){return y(r,m,this)};var h=function(r){return r.$u?f.utc():f()};l.toNow=function(r){return this.to(h(this),r)},l.fromNow=function(r){return this.from(h(this),r)}}})})(z);var it=z.exports;const ot=P(it);function at(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!Z(s)}I.extend(rt);I.extend(ot);function B(s){return Y("div",{class:"flex flex-row flex-wrap gap-0.5"},[s.map(c=>Y(L,{key:c},at(c)?c:{default:()=>[c]}))])}const ut=[{field:"userId",label:"用户ID"},{field:"status",label:"用户状态",render(s){return et(s,U.SYS_NORMAL_DISABLE)}},{field:"nickName",label:"用户信息",render(s,c){const{deptName:o="暂无部门信息",nickName:a,userName:f}=c;let l=o;return c.dept&&c.dept.deptName&&(l=c.dept.deptName),`${f} / ${a} / ${l}`}},{field:"phonenumber",label:"手机号",render(s){return s||"未设置手机号码"}},{field:"email",label:"邮箱",render(s){return s||"未设置邮箱地址"}},{field:"postNames",label:"岗位",render(s){return Array.isArray(s)&&s.length===0?"暂无信息":B(s)}},{field:"roleNames",label:"权限",render(s){return Array.isArray(s)&&s.length===0?"暂无信息":B(s)}},{field:"createTime",label:"创建时间"},{field:"loginIp",label:"上次登录IP",render(s){return s||Y("span",{class:"text-orange-500"},[E("从未登录过")])}},{field:"loginDate",label:"上次登录时间",render(s){if(!s)return Y("span",{class:"text-orange-500"},[E("从未登录过")]);I.locale("zh-cn");const c=I().diff(I(s),"second"),o=I.duration(c,"seconds").humanize();return Y("div",{class:"flex gap-2"},[s,Y(L,{bordered:!1,color:"cyan"},{default:()=>[o,E("前")]})])}},{field:"remark",label:"备注",render(s){return s||"无"}}],yt=q({__name:"user-info-modal",setup(s){const[c,o]=st({onOpenChange:l}),[a,{setDescProps:f}]=J({column:1,labelStyle:{minWidth:"150px",width:"150px"},schema:ut});function l(M){return H(this,null,function*(){if(!M)return null;o.modalLoading(!0);const{userId:y}=o.getData(),h=yield G(y),{postIds:r=[],posts:m=[],roleIds:w=[],roles:b=[],user:x}=h,D=m.filter(p=>r.includes(p.postId)).map(p=>p.postName),v=b.filter(p=>w.includes(p.roleId)).map(p=>p.roleName);x.postNames=D,x.roleNames=v,f({data:x}),o.modalLoading(!1)})}return(M,y)=>(Q(),X(j(c),{footer:!1,"fullscreen-button":!1,title:"用户信息"},{default:tt(()=>[Y(j(K),{onRegister:j(a)},null,8,["onRegister"])]),_:1}))}});export{yt as _};
