var re=Object.defineProperty,ae=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var M=(r,e,o)=>e in r?re(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o,u=(r,e)=>{for(var o in e||(e={}))ie.call(e,o)&&M(r,o,e[o]);if(D)for(var o of D(e))le.call(e,o)&&M(r,o,e[o]);return r},$=(r,e)=>ae(r,ne(e));var h=(r,e,o)=>M(r,typeof e!="symbol"?e+"":e,o);var b=(r,e,o)=>new Promise((g,d)=>{var y=l=>{try{x(o.next(l))}catch(w){d(w)}},C=l=>{try{x(o.throw(l))}catch(w){d(w)}},x=l=>l.done?g(l.value):Promise.resolve(l.value).then(y,C);x((o=o.apply(r,e)).next())});import{at as F,az as N,bu as ce,bf as p,bd as de,be as ue,k as G,i as fe,a9 as Q,ba as pe,aF as ge,J as v,a3 as me,ak as he,n as E,bc as U,aE as j,av as _,as as z,aw as B,ax as R,a8 as c,aC as J,ay as be,aG as ve,ar as ye,aH as Ce,b5 as I,b4 as xe,q as we,ac as Se,h as Ve}from"../jse/index-index-CulmqKVw.mjs";import{l as Oe,c4 as ke,c5 as Pe,m as _e,$ as W,c6 as ze}from"./bootstrap-CIlPtDbU.mjs";import{a as Ge,V as K,b as Te}from"./vxe-table-CS5KFeE-.mjs";import{V as He}from"./loading-7m7uS9S_.mjs";const Ee={},Le={height:"41",viewBox:"0 0 64 41",width:"64",xmlns:"http://www.w3.org/2000/svg"};function Me(r,e){return F(),N("svg",Le,e[0]||(e[0]=[ce('<g fill="none" fill-rule="evenodd" transform="translate(0 1)"><ellipse cx="32" cy="33" fill="hsl(var(--background-deep))" rx="32" ry="7"></ellipse><g fill-rule="nonzero" stroke="hsl(var(--heavy))"><path d="M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"></path><path d="M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z" fill="hsl(var(--accent))"></path></g></g>',1)]))}const $e=Oe(Ee,[["render",Me]]);function Be(){return{class:"",gridClass:"",gridOptions:{},gridEvents:{},formOptions:void 0}}class Re{constructor(e={}){h(this,"grid",{});h(this,"isMounted",!1);h(this,"state",null);h(this,"stateHandler");h(this,"store");const o=u({},e),g=Be();this.store=new ke(p(o,g),{onUpdate:()=>{this.state=this.store.state}}),this.state=this.store.state,this.stateHandler=new de,ue(this)}mount(e){!this.isMounted&&e&&(this.grid=e,this.stateHandler.setConditionTrue(),this.isMounted=!0)}query(){return b(this,arguments,function*(e={}){try{yield this.grid.commitProxy("query",G(e))}catch(o){console.error("Error occurred while querying:",o)}})}reload(){return b(this,arguments,function*(e={}){try{yield this.grid.commitProxy("reload",G(e))}catch(o){console.error("Error occurred while reloading:",o)}})}setGridOptions(e){this.setState({gridOptions:e})}setLoading(e){this.setState({gridOptions:{loading:e}})}setState(e){fe(e)?this.store.setState(o=>p(e(o),o)):this.store.setState(o=>p(e,o))}unmount(){this.isMounted=!1,this.stateHandler.reset()}}const Fe={key:0,class:"relative rounded py-3 pb-6"},Ne={class:"mt-2"},Ae=Q({__name:"use-vxe-grid",props:{api:{},class:{},gridClass:{},gridOptions:{},gridEvents:{},formOptions:{}},setup(r){var H,q;const e=r,o=pe("gridRef"),g=(q=(H=e.api)==null?void 0:H.useStore)==null?void 0:q.call(H),{gridOptions:d,class:y,gridClass:C,gridEvents:x,formOptions:l}=Pe(e,g),{isMobile:w}=_e(),a=ge(),[X,T]=Ge({}),L=v(()=>{var t,s;return!!((t=a["toolbar-actions"])!=null&&t.call(a))||!!((s=a["toolbar-tools"])!=null&&s.call(a))}),A=v(()=>{var S,V,O,k,P;const t=(S=a["toolbar-actions"])==null?void 0:S.call(a),s=(V=a["toolbar-tools"])==null?void 0:V.call(a),n=(P=(k=(O=K)==null?void 0:O.getConfig())==null?void 0:k.grid)!=null?P:{},m=L.value?{toolbarConfig:{slots:u(u({},t?{buttons:"toolbar-actions"}:{}),s?{tools:"toolbar-tools"}:{})}}:{},i=me(p({},m,G(d.value),n));if(i.proxyConfig){const{ajax:f}=i.proxyConfig;i.proxyConfig.enabled=!!f,i.proxyConfig.autoLoad=!1}if(!L.value&&i.toolbarConfig&&(i.toolbarConfig.enabled=!1),i.pagerConfig){const f=["PrevJump","PrevPage","Number","NextPage","NextJump"],se=["Total","Sizes","Home",...f,"End"];i.pagerConfig=p({},i.pagerConfig,{pageSize:20,background:!0,pageSizes:[10,20,30,50,100,200],className:"mt-2 w-full",layouts:w.value?f:se,size:"mini"})}return i.formConfig&&(i.formConfig.enabled=!1),i}),Y=v(()=>u({},x.value)),Z=v(()=>{const t={handleSubmit:()=>b(this,null,function*(){const n=T.form.values;e.api.reload(n)}),handleReset:()=>b(this,null,function*(){T.resetForm();const n=T.form.values;e.api.reload(n)}),commonConfig:{componentProps:{class:"w-full"}},showCollapseButton:!0,submitButtonOptions:{text:W("common.query")},wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},s=p({},l.value,t);return $(u({},s),{collapseTriggerResize:!!s.showCollapseButton})}),ee=v(()=>{const t=[];for(const s of Object.keys(a))["empty","form","loading"].includes(s)||t.push(s);return t}),oe=v(()=>{const t=[];for(const s of Object.keys(a))s.startsWith("form-")&&t.push(s);return t});function te(){return b(this,null,function*(){var S,V,O,k,P,f;yield we();const t=(O=(V=(S=K)==null?void 0:S.getConfig())==null?void 0:V.grid)!=null?O:{},n=(k=p({},G(d.value),G(t)).proxyConfig)==null?void 0:k.autoLoad;((P=A.value.proxyConfig)==null?void 0:P.enabled)&&n&&e.api.reload(T.form.values),((f=d.value)==null?void 0:f.formConfig)&&console.warn("[Vben Vxe Table]: The formConfig in the grid is not supported, please use the `formOptions` props")})}return he(()=>{var t,s;(s=(t=e.api)==null?void 0:t.mount)==null||s.call(t,o.value),te()}),(t,s)=>(F(),N("div",{class:xe(c(I)("bg-card h-full rounded-md",c(y)))},[E(c(Te),ye({ref_key:"gridRef",ref:o,class:c(I)("p-2",{"pt-0":L.value&&!c(l)},c(C))},A.value,Ce(Y.value)),U({form:_(()=>[c(l)?(F(),N("div",Fe,[z(t.$slots,"form",{},()=>[E(c(X),B(R(Z.value)),U({_:2},[j(oe.value,n=>({name:n,fn:_(m=>[z(t.$slots,n,B(R(m)))])}))]),1040)]),s[0]||(s[0]=J("div",{class:"bg-background-deep z-100 absolute -left-2 bottom-1 h-2 w-[calc(100%+1rem)] overflow-hidden md:bottom-2 md:h-3"},null,-1))])):be("",!0)]),loading:_(()=>[z(t.$slots,"loading",{},()=>[E(c(He),{spinning:!0})])]),empty:_(()=>[z(t.$slots,"empty",{},()=>[E(c($e),{class:"mx-auto"}),J("div",Ne,ve(c(W)("common.noData")),1)])]),_:2},[j(ee.value,n=>({name:n,fn:_(m=>[z(t.$slots,n,B(R(m)))])}))]),1040,["class"])],2))}});function Ie(r){const e=new Re(r),o=e;return o.useStore=d=>ze(e.store,d),[Q((d,{attrs:y,slots:C})=>(Se(()=>{e.unmount()}),()=>Ve(Ae,$(u(u({},d),y),{api:o}),C)),{inheritAttrs:!1,name:"VbenVxeGrid"}),o]}export{Ie as u};
