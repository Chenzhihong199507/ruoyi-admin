var r=(t,s,n)=>new Promise((l,p)=>{var m=e=>{try{a(n.next(e))}catch(o){p(o)}},i=e=>{try{a(n.throw(e))}catch(o){p(o)}},a=e=>e.done?l(e.value):Promise.resolve(e.value).then(m,i);a((n=n.apply(t,s)).next())});import{a as N}from"./index-DV03ZwLB.mjs";import{t as b}from"./mitt-DZbos8MC.mjs";import"./vxe-table-CS5KFeE-.mjs";import{g as u}from"./get-popup-container-BwMHEyJY.mjs";import{s as g,c as C}from"./bootstrap-CIlPtDbU.mjs";import{a9 as h,V as y,ak as I,b2 as w,at as P,au as v,av as d,n as c,a8 as f,aw as _,ax as S,aC as x,aD as V}from"../jse/index-index-CulmqKVw.mjs";import{C as q,R as T}from"./index-CwvHP01g.mjs";import{l as D,a as R}from"./tree-DR0G1ezI.mjs";const F=()=>[{component:"Divider",componentProps:{orientation:"left"},fieldName:"divider1",formItemClass:"col-span-2",label:"基本信息"},{component:"Input",fieldName:"tableName",label:"表名称",rules:"required"},{component:"Input",fieldName:"tableComment",label:"表描述",rules:"required"},{component:"Input",fieldName:"className",label:"实体类名称",rules:"required"},{component:"Input",fieldName:"functionAuthor",label:"作者",rules:"required"},{component:"Divider",componentProps:{orientation:"left"},fieldName:"divider2",formItemClass:"col-span-2",label:"生成信息"},{component:"Select",componentProps:{allowClear:!1,getPopupContainer:u,options:[{label:"单表(增删改查)",value:"crud"},{label:"树表(增删改查)",value:"tree"}]},defaultValue:"crud",fieldName:"tplCategory",label:"模板类型",rules:"selectRequired"},{component:"Select",componentProps:{getPopupContainer:u},dependencies:{show:t=>t.tplCategory==="tree",triggerFields:["tplCategory"]},fieldName:"treeCode",helpMessage:"树节点显示的编码字段名， 如: dept_id (相当于id)",label:"树编码字段",rules:"selectRequired"},{component:"Select",componentProps:{allowClear:!1},dependencies:{show:t=>t.tplCategory==="tree",triggerFields:["tplCategory"]},fieldName:"treeParentCode",help:"树节点显示的父编码字段名， 如: parent_Id (相当于parentId)",label:"树父编码字段",rules:"selectRequired"},{component:"Select",componentProps:{allowClear:!1},dependencies:{show:t=>t.tplCategory==="tree",triggerFields:["tplCategory"]},fieldName:"treeName",help:"树节点的显示名称字段名， 如: dept_name (相当于label)",label:"树名称字段",rules:"selectRequired"},{component:"Input",fieldName:"packageName",help:"生成在哪个java包下, 例如 com.ruoyi.system",label:"生成包路径",rules:"required"},{component:"Input",fieldName:"moduleName",help:"可理解为子系统名，例如 system",label:"生成模块名",rules:"required"},{component:"Input",fieldName:"businessName",help:"可理解为功能英文名，例如 user",label:"生成业务名",rules:"required"},{component:"Input",fieldName:"functionName",help:"用作类描述，例如 用户",label:"生成功能名",rules:"required"},{component:"TreeSelect",componentProps:{allowClear:!1,getPopupContainer:u},defaultValue:0,fieldName:"parentMenuId",label:"上级菜单"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:[{label:"modal弹窗",value:"modal"},{label:"drawer抽屉",value:"drawer"}],optionType:"button"},help:"自定义功能, 需要后端支持",defaultValue:"modal",fieldName:"popupComponent",label:"弹窗组件类型"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:[{label:"zip压缩包",value:"0"},{label:"自定义路径",value:"1"}],optionType:"button"},defaultValue:"0",fieldName:"genType",help:"默认为zip压缩包下载, 也可以自定义生成路径",label:"生成代码方式"},{component:"Input",defaultValue:"/",dependencies:{show:t=>t.genType==="1",triggerFields:["genType"]},fieldName:"genPath",help:'输入绝对路径, 不支持"./"相对路径',label:"代码生成路径",rules:g().regex(/^(?:[a-z]:)?(?:\/|(?:\\|\/)[^\\/:*?"<>|\r\n]+)*(?:\\|\/)?$/i,{message:"请输入合法的路径"})},{component:"Textarea",fieldName:"remark",formItemClass:"col-span-2 items-baseline",label:"备注"}],k={class:"flex justify-center"},H=h({__name:"basic-setting",setup(t){const s=y("genInfoData"),[n,l]=C({commonConfig:{componentProps:{class:"w-full",formItemClass:"col-span-1"},labelWidth:150},schema:F(),showDefaultActions:!1,wrapperClass:"grid-cols-2"});function p(a){return r(this,null,function*(){const e=a.map(o=>({label:`${o.columnName} | ${o.columnComment}`,value:o.columnName}));l.updateSchema([{componentProps:{options:e},fieldName:"treeCode"},{componentProps:{options:e},fieldName:"treeParentCode"},{componentProps:{options:e},fieldName:"treeName"}])})}function m(){return r(this,null,function*(){const a=yield N(),o=[{fullName:"根目录",menuId:0,menuName:"根目录",children:D(a,{id:"menuId",pid:"parentId"})}];R(o,"menuName"," / "),l.updateSchema([{componentProps:{fieldNames:{label:"menuName",value:"menuId"},listHeight:300,treeData:o,treeDefaultExpandAll:!1,treeDefaultExpandedKeys:[0],treeLine:{showLeafIcon:!1},treeNodeLabelProp:"fullName"},fieldName:"parentMenuId"}])})}I(()=>r(this,null,function*(){var e;const a=s.value;if(yield l.setValues(a),a.options){const o=(e=JSON.parse(a.options))==null?void 0:e.popupComponent;o&&(yield l.setFieldValue("popupComponent",o))}yield Promise.all([p(a.columns),m()])}));function i(){return r(this,null,function*(){try{const{valid:a}=yield l.validate();if(!a)return null;const e=yield l.getValues();Object.assign(s.value,e),b(1)}catch(a){console.error(a)}})}return(a,e)=>{const o=w("a-button");return P(),v(f(T),{justify:"center"},{default:d(()=>[c(f(q),_(S({xs:24,sm:24,md:20,lg:16,xl:16})),{default:d(()=>[c(f(n)),x("div",k,[c(o,{type:"primary",onClick:i},{default:d(()=>e[0]||(e[0]=[V("下一步")])),_:1})])]),_:1},16)]),_:1})}}});export{H as _};
