var j=Object.defineProperty;var $=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var _=(m,n,o)=>n in m?j(m,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):m[n]=o,N=(m,n)=>{for(var o in n||(n={}))E.call(n,o)&&_(m,o,n[o]);if($)for(var o of $(n))F.call(n,o)&&_(m,o,n[o]);return m};var u=(m,n,o)=>new Promise((f,k)=>{var s=p=>{try{b(o.next(p))}catch(C){k(C)}},w=p=>{try{b(o.throw(p))}catch(C){k(C)}},b=p=>p.done?f(p.value):Promise.resolve(p.value).then(s,w);b((o=o.apply(m,n)).next())});import{u as H,aq as h,k as v,M as Q,bC as D}from"./bootstrap-CIlPtDbU.mjs";import"./vxe-table-CS5KFeE-.mjs";import{s as J,b as I,a as M,c as K}from"./index-CS4ZLkSY.mjs";import{a as T}from"./download-BHYXKq0m.mjs";import U from"./code-preview-modal-CV6kOmP5.mjs";import{_ as W}from"./table-import-modal.vue_vue_type_script_setup_true_lang-DuX-m5OD.mjs";import{S as X}from"./index-BLUbi1M4.mjs";import{_ as Z}from"./page.vue_vue_type_script_setup_true_lang-BEwXti9W.mjs";import{a9 as V,Q as ee,b2 as te,at as oe,au as ae,av as i,n as l,a8 as d,aC as ie,aD as c,aG as g}from"../jse/index-index-CulmqKVw.mjs";import{u as ne}from"./use-vxe-grid-CIpB4HOm.mjs";import{u as x}from"./use-modal-BmBYziM1.mjs";import{P as S}from"./index-BLw-otuj.mjs";import"./render-C5tDa4zc.mjs";import"./data-CRYXvPFo.mjs";import"./index-BsPmTjuM.mjs";import"./colors-DLErT_a-.mjs";import"./dict-D8K1MO7Q.mjs";import"./index-B9BKRmLN.mjs";import"./index-CY4pGJKi.mjs";import"./Col-CY1020A8.mjs";import"./responsiveObserve-CKY_yQR9.mjs";import"./useFlexGapSupport-UdCnRdDh.mjs";import"./Trigger-CxuUq1Ff.mjs";import"./ResizeObserver.es-CDE7jhPe.mjs";import"./get-vP85LLZV.mjs";import"./useRefs-DXDFWT8O.mjs";import"./collapseMotion-BYkmK0aG.mjs";import"./debounce-iPjm31B_.mjs";import"./index-CbGq_Vdo.mjs";import"./FormItemContext-D-XKVqk8.mjs";import"./isPlainObject-D3JZnYxx.mjs";import"./EyeOutlined-Bhfo9c26.mjs";import"./CheckOutlined-CIq9xGup.mjs";import"./useMergedState-DtLgCtQF.mjs";import"./uuid-BthZQwsx.mjs";import"./index-B-WsVPHD.mjs";import"./statusUtils-C-zQFcRu.mjs";import"./slide-B9Yt64p6.mjs";import"./index-CwX3_37I.mjs";import"./List-B93VJ5nE.mjs";import"./index-yiE2I97I.mjs";import"./Checkbox-C1LX6amp.mjs";import"./index-uwSnP2fA.mjs";import"./eagerComputed-Bboi8kUT.mjs";import"./index-epHOG_uQ.mjs";import"./index-MMlqTCj9.mjs";import"./index-aPtpRG1I.mjs";import"./Group-B1PMGyxu.mjs";import"./index-CeJhG9t7.mjs";import"./index-CkI6h8s8.mjs";import"./index-BmGsg0FM.mjs";import"./index-CVEhXdRN.mjs";import"./icon-button.vue_vue_type_script_setup_true_lang-BMSbb8G-.mjs";import"./x-BK4QZNWW.mjs";import"./loading-7m7uS9S_.mjs";import"./index-crWPCwF-.mjs";const re=()=>[{component:"Select",defaultValue:"",fieldName:"dataName",label:"数据源"},{component:"Input",fieldName:"tableName",label:"表名称"},{component:"Input",fieldName:"tableComment",label:"表描述"},{component:"RangePicker",fieldName:"createTime",label:"创建时间"}],le=[{type:"checkbox",width:60},{field:"tableName",title:"表名称"},{field:"tableComment",title:"表描述"},{field:"className",title:"实体类"},{field:"createTime",title:"创建时间"},{field:"updateTime",title:"更新时间"},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",width:300}],dt=V({__name:"index",setup(m){const n={schema:re(),wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},o={checkboxConfig:{highlight:!0,reserve:!0,trigger:"row"},columns:le,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(a,r)=>u(this,[a,r],function*({page:t},e){return e!=null&&e.createTime?(e.params={beginTime:D(e.createTime[0]).format("YYYY-MM-DD 00:00:00"),endTime:D(e.createTime[1]).format("YYYY-MM-DD 23:59:59")},Reflect.deleteProperty(e,"createTime")):Reflect.deleteProperty(e,"params"),yield K(N({pageNum:t.currentPage,pageSize:t.pageSize},e))})}},rowConfig:{isHover:!0,keyField:"tableId"},round:!0,align:"center",showOverflow:!0},f=ee(!1),[k,s]=ne({formOptions:n,gridOptions:o,gridEvents:{checkboxChange:t=>{f.value=t.records.length>0},checkboxAll:t=>{f.value=t.records.length>0}}}),[w,b]=x({connectedComponent:U});function p(t){b.setData({tableId:t.tableId}),b.open()}const C=H();function z(t){C.push(`/code-gen/edit/${t.tableId}`)}function P(t){return u(this,null,function*(){yield J(t.tableId),yield s.query()})}function R(){return u(this,null,function*(){const e=s.grid.getCheckboxRecords().map(r=>r.tableId);if(e.length===0){v.info("请选择需要生成代码的表");return}const a=v.loading("下载中...");try{const r=e.join(","),y=yield I(r),O=Date.now();T(y,`批量代码生成_${O}.zip`)}finally{a()}})}function Y(t){return u(this,null,function*(){const e=v.loading("下载中...");try{const a=yield I(t.tableId),r=`代码生成_${t.tableName}_${new Date().toLocaleString()}.zip`;T(a,r)}catch(a){console.error(a)}finally{e()}})}function q(t){return u(this,null,function*(){yield M(t.tableId),yield s.query()})}function B(){const e=s.grid.getCheckboxRecords().map(a=>a.tableId);Q.confirm({title:"提示",okType:"danger",content:`确认删除选中的${e.length}条记录吗？`,onOk:()=>u(this,null,function*(){yield M(e),yield s.query(),f.value=!1})})}const[A,G]=x({connectedComponent:W});function L(){G.open()}return(t,e)=>{const a=te("a-button");return oe(),ae(d(Z),{"auto-content-height":!0},{default:i(()=>[l(d(k),null,{"toolbar-actions":i(()=>e[3]||(e[3]=[ie("span",{class:"pl-[7px] text-[16px]"},"代码生成列表",-1)])),"toolbar-tools":i(()=>[l(d(X),null,{default:i(()=>[l(a,{disabled:!f.value,danger:"",type:"primary",onClick:B},{default:i(()=>[c(g(t.$t("pages.common.delete")),1)]),_:1},8,["disabled"]),l(a,{disabled:!f.value,onClick:R},{default:i(()=>[c(g(t.$t("pages.common.generate")),1)]),_:1},8,["disabled"]),l(a,{type:"primary",onClick:L},{default:i(()=>[c(g(t.$t("pages.common.import")),1)]),_:1})]),_:1})]),action:i(({row:r})=>[l(a,{size:"small",type:"link",onClick:h(y=>p(r),["stop"])},{default:i(()=>[c(g(t.$t("pages.common.preview")),1)]),_:2},1032,["onClick"]),l(a,{size:"small",type:"link",onClick:h(y=>z(r),["stop"])},{default:i(()=>[c(g(t.$t("pages.common.edit")),1)]),_:2},1032,["onClick"]),l(d(S),{title:`确认同步[${r.tableName}]?`,placement:"left",onConfirm:y=>P(r)},{default:i(()=>[l(a,{size:"small",type:"link",onClick:e[0]||(e[0]=h(()=>{},["stop"]))},{default:i(()=>[c(g(t.$t("pages.common.sync")),1)]),_:1})]),_:2},1032,["title","onConfirm"]),l(a,{size:"small",type:"link",onClick:h(y=>Y(r),["stop"])},{default:i(()=>e[4]||(e[4]=[c(" 生成代码 ")])),_:2},1032,["onClick"]),l(d(S),{title:`确认删除[${r.tableName}]?`,placement:"left",onConfirm:y=>q(r)},{default:i(()=>[l(a,{danger:"",size:"small",type:"link",onClick:e[1]||(e[1]=h(()=>{},["stop"]))},{default:i(()=>[c(g(t.$t("pages.common.delete")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1}),l(d(w)),l(d(A),{onReload:e[2]||(e[2]=r=>d(s).query())})]),_:1})}}});export{dt as default};
