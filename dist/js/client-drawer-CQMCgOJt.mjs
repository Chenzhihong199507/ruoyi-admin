var m=(e,f,r)=>new Promise((l,d)=>{var b=o=>{try{c(r.next(o))}catch(t){d(t)}},n=o=>{try{c(r.throw(o))}catch(t){d(t)}},c=o=>o.done?l(o.value):Promise.resolve(o.value).then(b,n);c((r=r.apply(e,f)).next())});import{K as s,$ as w,l as N}from"./bootstrap-CIlPtDbU.mjs";import{u as T}from"./vxe-table-CS5KFeE-.mjs";import{c as v,a as D,b as P}from"./index-Dp5S5Jis.mjs";import{g as u,e as C,f as A,r as L}from"./render-C5tDa4zc.mjs";import{g as _}from"./get-popup-container-BwMHEyJY.mjs";import k from"./secret-input-CtJCNzVx.mjs";import{a9 as E,Q as V,J as Y,a3 as q,at as F,au as x,av as S,n as y,a8 as h,ar as O}from"../jse/index-index-CulmqKVw.mjs";import{u as R}from"./use-drawer-0pSlBI5S.mjs";const X=()=>[{component:"Input",fieldName:"clientKey",label:"客户端key"},{component:"Input",fieldName:"clientSecret",label:"客户端密钥"},{component:"Select",componentProps:{options:u(s.SYS_NORMAL_DISABLE)},fieldName:"status",label:"状态"}],Z=[{type:"checkbox",width:60},{title:"客户端ID",field:"clientId",showOverflow:!0},{title:"客户端key",field:"clientKey"},{title:"客户端密钥",field:"clientSecret"},{title:"授权类型",field:"grantTypeList",slots:{default:({row:e})=>e.grantTypeList?C(e.grantTypeList,A(s.SYS_GRANT_TYPE)):"无"}},{title:"设备类型",field:"deviceType",slots:{default:({row:e})=>L(e.deviceType,s.SYS_DEVICE_TYPE)}},{title:"token活跃时间",field:"activeTimeout",formatter({row:e}){return`${e.activeTimeout}秒`}},{title:"token超时时间",field:"timeout",formatter({row:e}){return`${e.timeout}秒`}},{title:"状态",field:"status",slots:{default:"status"}},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",width:180}],B=()=>[{component:"Input",dependencies:{show:()=>!1,triggerFields:[""]},fieldName:"id",label:"id"},{component:"Input",componentProps:{disabled:!0},dependencies:{show:()=>!1,triggerFields:[""]},fieldName:"clientId",label:"客户端ID"},{component:"Input",fieldName:"clientKey",label:"客户端key",rules:"required"},{component:"Input",fieldName:"clientSecret",label:"客户端密钥",rules:"required"},{component:"Select",componentProps:{class:"w-full",getPopupContainer:_,mode:"multiple",optionFilterProp:"label",options:u(s.SYS_GRANT_TYPE)},fieldName:"grantTypeList",label:"授权类型",rules:"selectRequired"},{component:"Select",componentProps:{allowClear:!1,class:"w-full",getPopupContainer:_,options:u(s.SYS_DEVICE_TYPE)},fieldName:"deviceType",label:"设备类型",rules:"selectRequired"},{component:"InputNumber",componentProps:{addonAfter:"秒",placeholder:"请输入"},defaultValue:1800,fieldName:"activeTimeout",formItemClass:"col-span-2 lg:col-span-1",help:"指定时间无操作则过期(单位：秒), 默认30分钟(1800秒)",label:"Token活跃超时时间",rules:"required"},{component:"InputNumber",componentProps:{addonAfter:"秒"},defaultValue:604800,fieldName:"timeout",formItemClass:"col-span-2 lg:col-span-1 ",help:"指定时间必定过期(单位：秒)，默认七天(604800秒)",label:"Token固定超时时间",rules:"required"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:u(s.SYS_NORMAL_DISABLE),optionType:"button"},defaultValue:"0",fieldName:"status",label:"状态"}],K=E({__name:"client-drawer",emits:["reload"],setup(e,{emit:f}){const r=f,l=V(!1),d=Y(()=>l.value?w("pages.common.edit"):w("pages.common.add")),[b,n]=T({commonConfig:{formItemClass:"col-span-2"},layout:"vertical",schema:B(),showDefaultActions:!1,wrapperClass:"grid-cols-2"});function c(a){n.updateSchema([{dependencies:{show:()=>a,triggerFields:[""]},fieldName:"clientId"},{componentProps:{disabled:a},fieldName:"clientKey"},{componentProps:{disabled:a},fieldName:"clientSecret"}])}const[o,t]=R({onCancel:g,onConfirm:I,onOpenChange(a){return m(this,null,function*(){if(!a)return null;t.drawerLoading(!0);const{id:i}=t.getData();if(l.value=!!i,c(l.value),l.value&&i){const p=yield v(i);n.updateSchema([{componentProps:{disabled:p.id===1},fieldName:"status"}]),yield n.setValues(p)}t.drawerLoading(!1)})}});function I(){return m(this,null,function*(){try{t.drawerLoading(!0);const{valid:a}=yield n.validate();if(!a)return;const i=q(yield n.getValues());yield l.value?D(i):P(i),r("reload"),yield g()}catch(a){console.error(a)}finally{t.drawerLoading(!1)}})}function g(){return m(this,null,function*(){t.close(),yield n.resetForm()})}return(a,i)=>(F(),x(h(o),{"close-on-click-modal":!1,title:d.value,class:"w-[600px]"},{default:S(()=>[y(h(b),null,{clientSecret:S(p=>[y(k,O(p,{disabled:l.value}),null,16,["disabled"])]),_:1})]),_:1},8,["title"]))}}),$=N(K,[["__scopeId","data-v-42bbcbde"]]),ee=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"}));export{Z as a,ee as b,$ as c,X as q};
